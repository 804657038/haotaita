<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
		<meta content="yes" name="apple-mobile-web-app-capable"/>
	    <meta content="black" name="apple-mobile-web-app-status-bar-style"/>
	    <meta content="telephone=no" name="format-detection"/>
		<title>好太太</title>
		<link rel="stylesheet" href="css/person.css" />
		<link rel="stylesheet" href="css/demo.css" />
		<link rel="stylesheet" href="css/ydui.css" />
		<script src="js/ydui.flexible.js"></script>
<!--		<script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>-->
		<script src="js/jquery.min.js"></script>
		<script src="https://cdn.bootcss.com/layer/3.0.3/layer.min.js"></script>

	</head>
	<body>
		<!--填写个人信息-->
		<div  class="box" id="box1" style="display: none;">
			<div id="person" >
				<div class="person" >
					<img src="img/submitBkg.png" />
					<img src="img/inforTitle.png" />
					<img src="img/inforClose.png" class="inforClose" />
					<form>
						<ul>
							<li>
								<input type="text" name="name" placeholder="请输入姓名" />
							</li>
							<li>
								<input type="text" name="phone" placeholder="请输入手机号码" id="tellphone" maxlength="11"/>
							</li>
							<li>
								<input type="text" placeholder="省/市/区" id="J_Address"/>
							</li>
							<li>
								<textarea placeholder="请输详细街道地址" name="addres"></textarea>
							</li>
							<li>
								<textarea placeholder="请输你的留言建议" name="msg"></textarea>
							</li>
							<li>
								<a href="###" style="display: block;"><img src="img/submit.png" id="submit"/></a>
							</li>
						</ul>
					</form>
				</div>
			</div>
		</div>
		<!--奖品信息-->
		<div  class="box" id="box2" style="display: none;">
			<div id="awards">
				<div class="awards">
					<img src="img/lookBkg.png" />
					<img src="img/awardDetails.png" />
					<img src="img/inforClose.png" class="inforClose" />
					<div  class="awardInfor">
						<ul>
							<li>
								<p class="name">姓名：</p>
							</li>
							<li>
								<p class="phone">手机：</p>
							</li>
							<li>
								<p class="address">地址：</p>
							</li>
							<li>
								<p class="word">留言：·</p>
							</li>
						</ul>
					</div>
					<div class="awardTitle">
						<ul>
							<li>
								<p>奖品由好太太集团总部包邮寄出，请注意签收。若有疑问，可以在好太太服务号留言咨询。</p>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!--安装地址-->
		<div class="box" id="box3" style="display: none;">
			<div id="install" >
				<div class="install" >
					<img src="img/installBkg.png" />
					<img src="img/inforTitle.png" />
					<img src="img/inforClose.png" class="inforClose" />
					<ul>
						<li>
							<input type="text" name="name" placeholder="请输入您的名字"/>
						</li>
						<li>
							<input type="text" name="mobile" placeholder="请输入您的手机号码" maxlength="11" id="installPhone"/>
						</li>
						<li>
							<input type="text"  placeholder="省/市/区" id="installCity"/>
						</li>
						<li>
							<textarea placeholder="请输详细街道地址" name="addres"></textarea>
						</li>
						<li>
							<a href="###" style="display: block;" ><img src="img/submit.png" id="installSubmit" /></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!--填写型号-->
		<div  class="box" id="box4" style="display: none;">
			<div id="set" >
				<div class="set" >
					<img src="img/seting.png" />
					<img src="img/inforTitle.png" />
					<img src="img/inforClose.png" class="inforClose" />
					<form>
						<ul>
							<li>
								<input type="text" name="name" placeholder="请输入姓名" />
							</li>
							<li>
								<input type="text" name="phone" placeholder="请输入手机号码" id="setPhone" maxlength="11"/>
							</li>
							<li>
								<input type="text" placeholder="省/市/区" id="setCity"/>
							</li>
							<li>
								<a href="###" style="display: block;" ><img src="img/submit.png" id="setSubmit" /></a>
							</li>
						</ul>
					</form>
				</div>
			</div>
		</div>
	</body>
	
	<script src="js/ydui.citys.js"></script>
	<script src="js/ydui.js"></script>
	<script>
		$(function(){
			$(document).on('focusin','input',function(){
				window.parent.$('#good').hide();
			});
			$(document).on('focusout','input',function(){
				window.parent.$('#good').show();
			});
			$(document).on('focusin','textarea',function(){
				window.parent.$('#good').hide();
			});
			$(document).on('focusout','textarea',function(){
				window.parent.$('#good').show();
			});
			//我也要玩
            var event="click";
			$(document).on(event,".inforClose",function(){
				if(window.parent.gameOrAward==true)
				{
					window.parent.shankOpen=true;
				}
				window.parent.$('#personInfor').hide();
				$('#box1 input').val("");
				$('#box1 textarea').val("");
				$('#box2 input').val("");
				$('#box2 textarea').val("");
				$('#box3 input').val("");
				$('#box3 textarea').val("");
				$('#box4 input').val("");
				$('#box4 textarea').val("");
			});

			//购买类型提交
			$(document).on(event,"#setSubmit",function(){
                var id=window.parent.id;

				//向服务器发送数据成功执行以下语句


                window.parent.AjaxR(window.parent.link+'counpAdd','POST',{
                    "__token__":window.parent.token,
                    "id":id,
                    "name":$('#box4').find("[name='name']").val(),
                    "mobile":$('#box4').find("[name='phone']").val(),
                    "setCity":$('#box4').find("#setCity").val()
                },function(res){
                    window.parent.token=res.token;
                    if(res.code==1){
                        layer.msg('信息已提交',{
                            time: 1500
                        });
                        $('.inforClose').trigger(event);

                        if(window.parent.wordIndex){
                            var self =window.parent.awardLists[window.parent.wordIndex];
                            self.use.visible = false;
                            self.donate.visible = false;
                            self.look.visible = true;
                        }
                    }else{
                        layer.msg(res.msg,{
                            time: 1500
                        });
                    }
                });
			});
			//礼包兑换提交
			$(document).on(event,"#submit",function(){
                var id=window.parent.id;
                var token=window.parent.token;
				//向服务器发送数据成功执行以下语句

                window.parent.AjaxR(window.parent.link+'lottAdd','POST',{
                    "__token__":token,
                    "id":id,
                    "name":$('#box1').find("[name='name']").val(),
                    "mobile":$('#box1').find("[name='phone']").val(),
                    "region":$('#box1').find("#J_Address").val(),
                    "addres":$('#box1').find("[name='addres']").val(),
                    "msg":$('#box1').find("[name='msg']").val(),
                },function(res){
                    window.parent.token=res.token;
                    if(window.parent.gameOrAward==true)
					{
						window.parent.shankOpen=true;
					}
                    if(res.code==1){
                        layer.msg('信息已提交',{
                            time: 1500
                        });
                        $('.inforClose').trigger(event);

                        if(window.parent.wordIndex && window.parent.awardLists){
                            var self =window.parent.awardLists[window.parent.wordIndex];
                            self.exchange.visible = false;
//				   self.donate.visible = false;
                            self.look.visible = true;
                        }
                    }else{
                        layer.msg(res.msg,{
                            time: 1500
                        });
                    }
                });
			});
			//免单券
            $(document).on(event,"#installSubmit",function(){
                var id=window.parent.id;

                //向服务器发送数据成功执行以下语句
                var self =window.parent.awardLists[window.parent.wordIndex];
                self.use.visible = false;
                self.donate.visible = false;
                self.look.visible = true;
                window.parent.AjaxR(window.parent.link+'counpAdd','POST',{
                    "__token__":window.parent.token,
                    "id":id,
                    "name":$('#box3').find("[name='name']").val(),
                    "mobile":$('#box3').find("[name='mobile']").val(),
                    "setCity":$('#box3').find("#installCity").val(),
                    "addres":$('#box3').find("[name='addres']").val(),
                    "type":2
                },function(res){
                    window.parent.token=res.token;
                    if(res.code==1){
                        layer.msg('信息已提交',{
                            time: 1500
                        });
                        $('.inforClose').trigger(event);
                    }else{
                        layer.msg(res.msg,{
                            time: 1500
                        });
                    }
                });
            });

			//手机验证
			var reg = /^1[3|5|7|8]\d{9}$/;
			$('#tellphone').focusout(function(){
				if($(this).val().length==0)
				{
					layer.tips('请输入手机号码！', this, {
					  tips: [1],
					  time: 1500
					});
				}else if(!reg.test($(this).val()))
				{
					layer.tips('手机号码格式有误！', this, {
					  tips: [1],
					  time: 1500
					});
				}
			});
			$('#installPhone').focusout(function(){
				if($(this).val().length==0)
				{
					layer.tips('请输入手机号码！', this, {
					  tips: [1],
					  time: 1500
					});
				}else if(!reg.test($(this).val()))
				{
					layer.tips('手机号码格式有误！', this, {
					  tips: [1],
					  time: 1500
					});
				}
			});
			$('#setPhone').focusout(function(){
				if($(this).val().length==0)
				{
					layer.tips('请输入手机号码！', this, {
					  tips: [1],
					  time: 1500
					});
				}else if(!reg.test($(this).val()))
				{
					layer.tips('手机号码格式有误！', this, {
					  tips: [1],
					  time: 1500
					});
				}
			});
			
		});
		//省市区三级联动
		!function () {
	        var $target = $('#J_Address');
	
	        $target.citySelect();
	
	        $target.on('click', function (event) {
	            event.stopPropagation();
	            $target.citySelect('open');
	        });
	
	        $target.on('done.ydui.cityselect', function (ret) {
	            $(this).val(ret.provance + ' ' + ret.city + ' ' + ret.area);
	        });
	    }();
	    
	    !function () {
	        var $target = $('#installCity');
	
	        $target.citySelect();
	
	        $target.on('click', function (event) {
	            event.stopPropagation();
	            $target.citySelect('open');
	        });
	
	        $target.on('done.ydui.cityselect', function (ret) {
	            $(this).val(ret.provance + ' ' + ret.city + ' ' + ret.area);
	        });
	    }();
	    !function () {
	        var $target = $('#setCity');
	
	        $target.citySelect();
	
	        $target.on('click', function (event) {
	            event.stopPropagation();
	            $target.citySelect('open');
	        });
	
	        $target.on('done.ydui.cityselect', function (ret) {
	            $(this).val(ret.provance + ' ' + ret.city + ' ' + ret.area);
	        });
	    }();
	</script>

</html>
